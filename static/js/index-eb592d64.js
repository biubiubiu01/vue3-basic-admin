import{_ as U}from"./index-1543d802.js";import{_ as R}from"./index.vue_vue_type_script_setup_true_lang-127883b2.js";import{e as P,a as $,g as A,d as L,c as O}from"./user-097e959b.js";import{F as f}from"./componentEnum-3c525f4b.js";import{g as N}from"./role-b55ad24f.js";import{g as x}from"./dept-e238fd2a.js";import{S as V}from"./basic-2a5cf92e.js";import{_ as j}from"./index-d97fff49.js";import{d as T,b as F,r as E,a0 as B,U as K,o as C,A as k,w,f as _,g as s,l as I,v as q,a5 as z,be as M,c2 as S,c as H,e as G,i as J,ei as Q}from"./index-bd68377b.js";import{E as W}from"./el-tree-fb98b636.js";import"./el-checkbox-1de7bb5d.js";import{_ as X}from"./base-input.vue_vue_type_script_setup_true_lang-241af1dc.js";import{_ as Y}from"./base-dialog.vue_vue_type_style_index_0_lang-c14e94f3.js";import{_ as Z}from"./base-form.vue_vue_type_script_setup_true_lang-fd45b9d9.js";import"./base-table-cc75553f.js";/* empty css                 */import"./el-tag-680f8e7f.js";import"./base-select.vue_vue_type_script_lang-d001047d.js";import"./el-popper-ec19954e.js";import"./_Uint8Array-4312697e.js";import"./debounce-ba2e3c7a.js";import"./index-9fb5db53.js";import"./el-empty-b3683d32.js";import"./el-space-cf3eea44.js";/* empty css                  *//* empty css                        */import"./el-dropdown-item-1b1620d4.js";import"./dropdown-b3c61a52.js";import"./base-icon-picker.vue_vue_type_style_index_0_lang-c081a9c2.js";import"./base-column-setting-e54d99cc.js";import"./vuedraggable.umd-00c7ec58.js";import"./vue.runtime.esm-bundler-ce2cf429.js";import"./base-filter-33151ec2.js";import"./useTagViewSetting-d87808f0.js";import"./base-input-number-0811e547.js";import"./localeData-fba84234.js";import"./index-97a29ee2.js";import"./position-987e2487.js";import"./el-col-435232e7.js";import"./index-414ef697.js";import"./el-form-item-529a884a.js";function v(r){const m=[{fieldName:"username",fieldDesc:"\u7528\u6237\u540D",fieldType:f.INPUT},{fieldName:"role",fieldDesc:"\u89D2\u8272",fieldType:f.SELECT,config:{api:N,labelKey:"roleName",valueKey:"role"}},{fieldName:"status",fieldDesc:"\u72B6\u6001",fieldType:f.SELECT,config:{options:V}}],o=[{fieldName:"id",fieldDesc:"id",showOverflowTooltip:!0},{fieldName:"username",fieldDesc:"\u7528\u6237\u540D"},{fieldName:"deptName",fieldDesc:"\u90E8\u95E8",showOverflowTooltip:!0},{fieldName:"role",fieldDesc:"\u89D2\u8272",formType:"tag"},{fieldName:"status",fieldDesc:"\u72B6\u6001",formType:"switch",callFunction:r==null?void 0:r.changeSwitch},{fieldName:"createTime",fieldDesc:"\u521B\u5EFA\u65F6\u95F4",width:160},{fieldName:"remark",fieldDesc:"\u5907\u6CE8",showOverflowTooltip:!0,active:!1},{fieldName:"#",fieldDesc:"\u64CD\u4F5C",formType:"operation",width:155,fixed:"right",operation:[{icon:"edit",label:"\u7F16\u8F91",callFunction:r==null?void 0:r.edit},{icon:"delete",label:"\u5220\u9664",confirm:!0,callFunction:r==null?void 0:r.delete}]}],l=[{fieldName:"username",fieldDesc:"\u7528\u6237\u540D",fieldType:f.INPUT},{fieldName:"role",fieldDesc:"\u89D2\u8272",fieldType:f.SELECT,config:{api:N,valueKey:"role",multiple:!0}},{fieldName:"deptId",fieldDesc:"\u6240\u5C5E\u90E8\u95E8",fieldType:f.SELECT,config:{api:x,tree:!0,multiple:!0,init:!0,nodeKey:"deptId",props:{label:"deptName",children:"children"}}},{fieldName:"remark",fieldDesc:"\u5907\u6CE8",fieldType:f.INPUT,config:{type:"textarea"}}];return{filterColumn:m,tableColumn:o,dialogColumn:l}}const ee=T({__name:"DeptTree",emits:["filter"],setup(r,{emit:m}){const o=F({keyword:"",treeData:[],defaultProps:{children:"children",label:"deptName"}}),l=E();B(()=>{c()});const c=async()=>{const e=await x();o.treeData=e.data},p=(e,u)=>e?u[o.defaultProps.label].includes(e):!0,d=e=>{m("filter",e.deptId)};return K(()=>o.keyword,e=>{s(l).filter(e)}),(e,u)=>{const h=X,D=W,y=j;return C(),k(y,{title:"\u7EC4\u7EC7\u67B6\u6784",showHelp:"",helpText:"\u70B9\u51FB\u90E8\u95E8\u53EF\u663E\u793A\u5BF9\u5E94\u7684\u7528\u6237",class:"account-dept"},{extra:w(()=>[_(h,{modelValue:o.keyword,"onUpdate:modelValue":u[0]||(u[0]=g=>o.keyword=g),size:"small",style:{width:"145px"}},null,8,["modelValue"])]),default:w(()=>[_(D,{ref_key:"deptTreeRef",ref:l,"node-key":"deptId","highlight-current":"",data:o.treeData,props:o.defaultProps,"default-expand-all":"","expand-on-click-node":!1,onNodeClick:d,"filter-node-method":p},null,8,["data","props"])]),_:1})}}});const te=I(ee,[["__scopeId","data-v-1106f145"]]),oe=T({__name:"UserDialog",emits:["success"],setup(r,{expose:m,emit:o}){const{success:l}=S(),c=F({}),{dialogColumn:p}=v(),d=E(),e=E(),u=E(!1),h={username:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",trigger:["blur","change"]}],role:[{type:"array",required:!0,message:"\u8BF7\u9009\u62E9\u89D2\u8272",trigger:["blur","change"]}],deptId:[{type:"array",required:!0,message:"\u8BF7\u9009\u62E9\u90E8\u95E8",trigger:["blur","change"]}]},D=q(()=>s(u)?"\u4FEE\u6539\u7528\u6237":"\u65B0\u589E\u7528\u6237"),y=(a={})=>{s(d).showDialog(),z(()=>{var n,i;s(e).instance.resetFields(),u.value=!!a.id,s(u)&&Object.assign(c,a,{role:(n=a.role)==null?void 0:n.split(","),deptId:(i=a.deptId)==null?void 0:i.split(",").map(b=>parseFloat(b))})})},g=()=>{s(d).hideDialog()},t=async a=>{await s(e).instance.validate(async n=>{if(!n)return;const i=M(c);Object.assign(i,{deptId:i.deptId.join(),role:i.role.join()}),a(!0);try{s(u)?await P(i):await $(i),l(s(u)?"\u4FEE\u6539\u6210\u529F":"\u65B0\u589E\u6210\u529F\uFF01"),o("success"),g()}finally{a(!1)}})};return m({showDialog:y,hideDialog:g}),(a,n)=>{const i=Z,b=Y;return C(),k(b,{ref_key:"baseDialogRef",ref:d,width:"560px",title:s(D),onSave:t},{default:w(()=>[_(i,{ref_key:"baseFormRef",ref:e,columns:s(p),rules:h,model:c},null,8,["columns","model"])]),_:1},8,["title"])}}}),ae={class:"system-account-container flex"},se={class:"account-user"},re=T({name:"Account"}),ue=T({...re,setup(r){const{tableColumn:m,filterColumn:o}=v({edit:D,delete:y,changeSwitch:g}),{success:l}=S(),c=F({columns:o,showOpen:!1,onSearch:e,searchInfo:{deptId:""}}),p=F({columns:m,data:[],pagination:{currentPage:1,pageSize:10,total:0},onRefresh:e}),d=E();B(()=>{e()});async function e(){const{currentPage:t,pageSize:a}=p.pagination,n=await A({...c.searchInfo,currentPage:t,pageSize:a});p.data=n.data.list||[],p.pagination.total=n.data.total}function u(t){c.searchInfo.deptId=t,e()}function h(){s(d).showDialog()}function D(t){s(d).showDialog(t.row)}async function y(t){const{id:a}=t.row;await L({id:a}),l("\u5220\u9664\u6210\u529F"),e()}async function g(t){return Q(`\u786E\u8BA4\u8981${t.status===0?"\u542F\u7528":"\u505C\u7528"}\u8BE5\u7528\u6237\u5417?`).then(async()=>{await O({id:t.id}),l(`${t.status===0?"\u542F\u7528":"\u505C\u7528"}\u6210\u529F`),e()})}return(t,a)=>{const n=R,i=U;return C(),H("div",ae,[_(te,{onFilter:u}),G("div",se,[_(i,{"table-title":"\u7528\u6237\u5217\u8868","filter-config":c,"table-config":p},{buttons:w(()=>[_(n,{type:"primary",onClick:h},{default:w(()=>[J("\u65B0\u589E\u7528\u6237")]),_:1})]),_:1},8,["filter-config","table-config"])]),_(oe,{ref_key:"userDialogRef",ref:d,onSuccess:e},null,512)])}}});const Je=I(ue,[["__scopeId","data-v-47514756"]]);export{Je as default};
